<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3タップルールズ</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body{background:#f9fff9;font-family:"Helvetica",sans-serif;margin:0;padding-bottom:90px}
    header{background:#00bfa5;color:#fff;text-align:center;padding:16px 0;font-size:24px;font-weight:bold;border-bottom-left-radius:25px;border-bottom-right-radius:25px}
    .card{background:#fff;border-radius:20px;margin:18px 16px;padding:18px 16px;box-shadow:0 4px 10px rgba(0,0,0,.06)}
    .title{font-size:26px;font-weight:800;color:#0f8a62;margin:12px 16px 0}
    .desc{font-size:18px;line-height:1.7;color:#222;margin:6px 0 0}
    .meta{color:#666;font-size:14px;margin:0 0 6px}
    .btn-main{display:block;width:82%;max-width:520px;margin:18px auto;background:#FFD84D;color:#00997f;font-weight:800;text-align:center;border-radius:40px;padding:14px 16px;border:none;box-shadow:0 6px 14px rgba(0,0,0,.12);text-decoration:none}
    .btn-main:active{transform:translateY(1px)}
    .bottom-nav{position:fixed;left:0;bottom:0;width:100%;height:70px;background:#fff;border-top:1px solid #ddd;display:flex;justify-content:space-around;align-items:center;box-shadow:0 -2px 8px rgba(0,0,0,.05);z-index:1000}
    .bottom-nav img{width:50px;height:auto}
  </style>
</head>
<body>
  <header>3タップルールズ</header>
  <h1 id="ruleTitle" class="title"></h1>
  <section class="card">
  <div id="ruleMeta" class="meta"></div>
  <p id="ruleDesc" class="desc"></p>
</section>

<!-- お気に入りボタン追加 -->
<button id="favButton" class="btn-main" style="background:#fff;border:2px solid #FFD84D;color:#00997f;">
  ★ お気に入りに追加
</button>

<a id="goDetail" class="btn-main" href="#">ペナルティと処置方法 →</a>

<script>
const favBtn = document.getElementById("favButton");
favBtn.addEventListener("click", () => {
  const id = new URLSearchParams(location.search).get("id");
  let favs = JSON.parse(localStorage.getItem("favorites") || "[]");
  if (!favs.includes(id)) {
    favs.push(id);
    localStorage.setItem("favorites", JSON.stringify(favs));
    favBtn.textContent = "★ 登録済み";
    favBtn.style.background = "#FFD84D";
  } else {
    favs = favs.filter(f => f !== id);
    localStorage.setItem("favorites", JSON.stringify(favs));
    favBtn.textContent = "☆ お気に入りに追加";
    favBtn.style.background = "#fff";
  }
});
</script>

  <script>
  (async()=>{
    const id=new URLSearchParams(location.search).get("id");
    const title=document.getElementById("ruleTitle");
    const desc=document.getElementById("ruleDesc");
    const meta=document.getElementById("ruleMeta");
    const btn=document.getElementById("goDetail");

    try{
      const res=await fetch("rules.json?v="+Date.now());
      const rules=await res.json();
      const r=rules.find(x=>String(x.id)===String(id));
      if(!r)throw new Error();
      title.textContent=r.title;
      desc.textContent=r.description;
      meta.textContent="カテゴリ："+r.category;
      if(!r.penalty&&!r.procedure) btn.style.display="none";
      else btn.href="rule_detail.html?id="+encodeURIComponent(id);
    }catch(e){
      title.textContent="ルールの読み込みに失敗しました";
      btn.style.display="none";
    }
  })();

</body>
</html>
